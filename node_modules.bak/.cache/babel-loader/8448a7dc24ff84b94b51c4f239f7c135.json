{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _defineProperty from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{useHistory}from\"react-router-dom\";import Alert from\"../common/Alert\";import{ToastProvider,useToasts}from'react-toast-notifications';/** Login form.\n *\n * Shows form and manages update to state on changes.\n * On submission:\n * - calls login function prop\n * - redirects to /companies route\n *\n * Routes -> LoginForm -> Alert\n * Routed as /login\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LoginForm(_ref){var login=_ref.login;var _useToasts=useToasts(),addToast=_useToasts.addToast;var history=useHistory();var _useState=useState({username:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),formErrors=_useState4[0],setFormErrors=_useState4[1];console.debug(\"LoginForm\",\"login=\",typeof login,\"formData=\",formData,\"formErrors\",formErrors);/** Handle form submit:\n   *\n   * Calls login func prop and, if successful, redirect to /companies.\n   */function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}/** Update form data field */function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(evt){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:evt.preventDefault();_context.prev=1;_context.next=4;return login(formData);case 4:result=_context.sent;if(result.success){history.push(\"/\");}else{result.errors.forEach(function(i){return addToast(i,{appearance:'error'});});}_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);if(_context.t0.length>0){addToast(_context.t0[0],{appearance:'error'});}setFormErrors(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return _handleSubmit.apply(this,arguments);}function handleChange(evt){var _evt$target=evt.target,name=_evt$target.name,value=_evt$target.value;setFormData(function(l){return _objectSpread(_objectSpread({},l),{},_defineProperty({},name,value));});}return/*#__PURE__*/_jsx(\"div\",{className:\"LoginForm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container col-md-6 offset-md-3 col-lg-4 offset-lg-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"mb-3\",children:\"Log In\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{name:\"username\",className:\"form-control\",value:formData.username,onChange:handleChange,autoComplete:\"username\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",className:\"form-control\",value:formData.password,onChange:handleChange,autoComplete:\"current-password\",required:true})]}),formErrors.length?/*#__PURE__*/_jsx(Alert,{type:\"danger\",messages:formErrors}):null,/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary float-right\",onSubmit:handleSubmit,children:\"Submit\"})]})})})]})});}export default LoginForm;","map":{"version":3,"names":["React","useState","useHistory","Alert","ToastProvider","useToasts","LoginForm","login","addToast","history","username","password","formData","setFormData","formErrors","setFormErrors","console","debug","handleSubmit","evt","preventDefault","result","success","push","errors","forEach","i","appearance","length","handleChange","target","name","value","l"],"sources":["/Users/mike/Desktop/scenic/src/auth/LoginForm.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport Alert from \"../common/Alert\";\nimport { ToastProvider, useToasts } from 'react-toast-notifications';\n\n\n/** Login form.\n *\n * Shows form and manages update to state on changes.\n * On submission:\n * - calls login function prop\n * - redirects to /companies route\n *\n * Routes -> LoginForm -> Alert\n * Routed as /login\n */\n\nfunction LoginForm({ login }) {\n  const { addToast } = useToasts();\n  const history = useHistory();\n  const [formData, setFormData] = useState({\n    username: \"\",\n    password: \"\",\n  });\n  const [formErrors, setFormErrors] = useState([]);\n\n  console.debug(\n      \"LoginForm\",\n      \"login=\", typeof login,\n      \"formData=\", formData,\n      \"formErrors\", formErrors,\n  );\n\n  /** Handle form submit:\n   *\n   * Calls login func prop and, if successful, redirect to /companies.\n   */\n\n  async function handleSubmit(evt) {\n    evt.preventDefault();\n    try {\n      let result = await login(formData);\n      if (result.success) {\n        history.push(\"/\");\n      } else {\n        result.errors.forEach(i =>  addToast(i, { appearance: 'error' }));\n      }\n    } catch (errors) {\n      if (errors.length > 0) {\n        addToast(errors[0], { appearance: 'error' });\n      }\n      setFormErrors(errors);\n    }\n  }\n\n  /** Update form data field */\n  function handleChange(evt) {\n    const { name, value } = evt.target;\n    setFormData(l => ({ ...l, [name]: value }));\n  }\n\n  return (\n      <div className=\"LoginForm\">\n        <div className=\"container col-md-6 offset-md-3 col-lg-4 offset-lg-4\">\n          <h3 className=\"mb-3\">Log In</h3>\n\n          <div className=\"card\">\n            <div className=\"card-body\">\n              <form onSubmit={handleSubmit}>\n                <div className=\"form-group\">\n                  <label>Username</label>\n                  <input\n                      name=\"username\"\n                      className=\"form-control\"\n                      value={formData.username}\n                      onChange={handleChange}\n                      autoComplete=\"username\"\n                      required\n                  />\n                </div>\n                <div className=\"form-group\">\n                  <label>Password</label>\n                  <input\n                      type=\"password\"\n                      name=\"password\"\n                      className=\"form-control\"\n                      value={formData.password}\n                      onChange={handleChange}\n                      autoComplete=\"current-password\"\n                      required\n                  />\n                </div>\n\n                {formErrors.length\n                    ? <Alert type=\"danger\" messages={formErrors} />\n                    : null}\n\n                <button\n                    className=\"btn btn-primary float-right\"\n                    onSubmit={handleSubmit}\n                >\n                  Submit\n                </button>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n  );\n}\n\nexport default LoginForm;\n"],"mappings":"ikBAAA,MAAOA,MAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,UAAU,KAAQ,kBAAkB,CAC7C,MAAOC,MAAK,KAAM,iBAAiB,CACnC,OAASC,aAAa,CAAEC,SAAS,KAAQ,2BAA2B,CAGpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GATA,wFAWA,QAASC,UAAS,MAAY,IAATC,MAAK,MAALA,KAAK,CACxB,eAAqBF,SAAS,EAAE,CAAxBG,QAAQ,YAARA,QAAQ,CAChB,GAAMC,QAAO,CAAGP,UAAU,EAAE,CAC5B,cAAgCD,QAAQ,CAAC,CACvCS,QAAQ,CAAE,EAAE,CACZC,QAAQ,CAAE,EACZ,CAAC,CAAC,wCAHKC,QAAQ,eAAEC,WAAW,eAI5B,eAAoCZ,QAAQ,CAAC,EAAE,CAAC,yCAAzCa,UAAU,eAAEC,aAAa,eAEhCC,OAAO,CAACC,KAAK,CACT,WAAW,CACX,QAAQ,CAAE,MAAOV,MAAK,CACtB,WAAW,CAAEK,QAAQ,CACrB,YAAY,CAAEE,UAAU,CAC3B,CAED;AACF;AACA;AACA,KAHE,QAKeI,aAAY,iDAiB3B,8HAjBA,iBAA4BC,GAAG,+HAC7BA,GAAG,CAACC,cAAc,EAAE,CAAC,sCAEAb,MAAK,CAACK,QAAQ,CAAC,QAA9BS,MAAM,eACV,GAAIA,MAAM,CAACC,OAAO,CAAE,CAClBb,OAAO,CAACc,IAAI,CAAC,GAAG,CAAC,CACnB,CAAC,IAAM,CACLF,MAAM,CAACG,MAAM,CAACC,OAAO,CAAC,SAAAC,CAAC,QAAKlB,SAAQ,CAACkB,CAAC,CAAE,CAAEC,UAAU,CAAE,OAAQ,CAAC,CAAC,GAAC,CACnE,CAAC,+EAED,GAAI,YAAOC,MAAM,CAAG,CAAC,CAAE,CACrBpB,QAAQ,CAAC,YAAO,CAAC,CAAC,CAAE,CAAEmB,UAAU,CAAE,OAAQ,CAAC,CAAC,CAC9C,CACAZ,aAAa,aAAQ,CAAC,oEAEzB,+CAGD,QAASc,aAAY,CAACV,GAAG,CAAE,CACzB,gBAAwBA,GAAG,CAACW,MAAM,CAA1BC,IAAI,aAAJA,IAAI,CAAEC,KAAK,aAALA,KAAK,CACnBnB,WAAW,CAAC,SAAAoB,CAAC,wCAAUA,CAAC,wBAAGF,IAAI,CAAGC,KAAK,IAAG,CAAC,CAC7C,CAEA,mBACI,YAAK,SAAS,CAAC,WAAW,uBACxB,aAAK,SAAS,CAAC,qDAAqD,wBAClE,WAAI,SAAS,CAAC,MAAM,UAAC,QAAM,EAAK,cAEhC,YAAK,SAAS,CAAC,MAAM,uBACnB,YAAK,SAAS,CAAC,WAAW,uBACxB,cAAM,QAAQ,CAAEd,YAAa,wBAC3B,aAAK,SAAS,CAAC,YAAY,wBACzB,uBAAO,UAAQ,EAAQ,cACvB,cACI,IAAI,CAAC,UAAU,CACf,SAAS,CAAC,cAAc,CACxB,KAAK,CAAEN,QAAQ,CAACF,QAAS,CACzB,QAAQ,CAAEmB,YAAa,CACvB,YAAY,CAAC,UAAU,CACvB,QAAQ,OACV,GACE,cACN,aAAK,SAAS,CAAC,YAAY,wBACzB,uBAAO,UAAQ,EAAQ,cACvB,cACI,IAAI,CAAC,UAAU,CACf,IAAI,CAAC,UAAU,CACf,SAAS,CAAC,cAAc,CACxB,KAAK,CAAEjB,QAAQ,CAACD,QAAS,CACzB,QAAQ,CAAEkB,YAAa,CACvB,YAAY,CAAC,kBAAkB,CAC/B,QAAQ,OACV,GACE,CAELf,UAAU,CAACc,MAAM,cACZ,KAAC,KAAK,EAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAEd,UAAW,EAAG,CAC7C,IAAI,cAEV,eACI,SAAS,CAAC,6BAA6B,CACvC,QAAQ,CAAEI,YAAa,UAC1B,QAED,EAAS,GACJ,EACH,EACF,GACF,EACF,CAEZ,CAEA,cAAeZ,UAAS"},"metadata":{},"sourceType":"module"}