{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useHistory}from\"react-router-dom\";import BywayApi from\"../api/api\";import SearchForm from\"./SearchForm\";import BywayCard from\"../byways/BywayCard\";import Pagination from\"../common/Pagination\";import{useToasts}from'react-toast-notifications';// search via filters, go to browse by state, go to display and search users\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function FilterSearch(){var _useToasts=useToasts(),addToast=_useToasts.addToast;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),byways=_useState2[0],setByways=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),currentByWays=_useState6[0],setCurrentByWays=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),currentPage=_useState8[0],setCurrentPage=_useState8[1];var _useState9=useState(10),_useState10=_slicedToArray(_useState9,1),bywaysPerPage=_useState10[0];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),nPages=_useState12[0],setNPages=_useState12[1];var history=useHistory();useEffect(function(){setNPages(Math.ceil(byways.length/bywaysPerPage));var indexOfLastByway=currentPage*bywaysPerPage;var indexOfFirstByway=indexOfLastByway-bywaysPerPage;var currentByways=byways.slice(indexOfFirstByway,indexOfLastByway);setCurrentByWays(currentByways);},[byways,currentPage]);// every time currentPage changes, the useEffect runs\nuseEffect(function(){function getBywaysForDisplay(){return _getBywaysForDisplay.apply(this,arguments);}function _getBywaysForDisplay(){_getBywaysForDisplay=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var byways;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return BywayApi.getAllByways();case 2:byways=_context.sent;setByways(byways);case 4:case\"end\":return _context.stop();}}},_callee);}));return _getBywaysForDisplay.apply(this,arguments);}getBywaysForDisplay();},[]);// display error to user - try/catch?\nfunction filterByways(_x){return _filterByways.apply(this,arguments);}function _filterByways(){_filterByways=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(filters){var _byways;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;debugger;_context2.next=4;return BywayApi.search(filters);case 4:_byways=_context2.sent;setByways(_byways);if(!_byways.length){history.push(\"/noresults\");}_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);if(_context2.t0.length>0){addToast(_context2.t0[0],{appearance:'error'});// can add error messaging/alerts with Toast before anything is sent to the back, like so:\n//addToast(\"your search term must be more than 3 characters\", { appearance: 'error' });\n}setErrors(_context2.t0);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return _filterByways.apply(this,arguments);}function search(_x2){return _search.apply(this,arguments);}function _search(){_search=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(name){var byways;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return BywayApi.search({name:name});case 2:byways=_context3.sent;setByways(byways);if(!byways.length){history.push(\"/noresults\");// Alert type=\"success\" messages={[\"Updated successfully.\"]} \n}case 5:case\"end\":return _context3.stop();}}},_callee3);}));return _search.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(SearchForm,{searchFor:search,filterByways:filterByways,errors:errors})}),/*#__PURE__*/_jsx(\"div\",{children:currentByWays.length>0?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:currentByWays.map(function(s){return/*#__PURE__*/_jsx(BywayCard,{name:s.name,image:s.image,designation:s.designation},s.name+s.state);})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Pagination,{nPages:nPages,currentPage:currentPage,setCurrentPage:setCurrentPage})})]}):/*#__PURE__*/_jsx(\"h4\",{children:\"no byways in system.\"})})]});}export default FilterSearch;","map":{"version":3,"names":["React","useState","useEffect","useHistory","BywayApi","SearchForm","BywayCard","Pagination","useToasts","FilterSearch","addToast","byways","setByways","errors","setErrors","currentByWays","setCurrentByWays","currentPage","setCurrentPage","bywaysPerPage","nPages","setNPages","history","Math","ceil","length","indexOfLastByway","indexOfFirstByway","currentByways","slice","getBywaysForDisplay","getAllByways","filterByways","filters","search","push","appearance","name","map","s","image","designation","state"],"sources":["/Users/mike/Desktop/scenic/src/search/FilterSearch.js"],"sourcesContent":["\nimport React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport BywayApi from \"../api/api\";\nimport SearchForm from \"./SearchForm\";\nimport BywayCard from \"../byways/BywayCard\";\nimport Pagination from \"../common/Pagination\";\nimport { useToasts } from 'react-toast-notifications';\n\n// search via filters, go to browse by state, go to display and search users\n\nfunction FilterSearch() {\n    const { addToast } = useToasts();\n    const [byways, setByways] = useState([]);\n    const [errors, setErrors] = useState([]);\n    const [currentByWays, setCurrentByWays] = useState([]);\n    const [currentPage, setCurrentPage] = useState(1);\n    const [bywaysPerPage] = useState(10);\n    \n    const [nPages, setNPages] = useState(0); \n\n    const history = useHistory();\n    \n    useEffect(() => {\n        setNPages(Math.ceil(byways.length / bywaysPerPage))\n        const indexOfLastByway = currentPage * bywaysPerPage;\n        const indexOfFirstByway = indexOfLastByway - bywaysPerPage;\n        const currentByways = byways.slice(indexOfFirstByway, indexOfLastByway)\n        setCurrentByWays(currentByways)\n\n    }, [byways, currentPage])\n    // every time currentPage changes, the useEffect runs\n\n    useEffect(() => {\n        async function getBywaysForDisplay() {\n            let byways = await BywayApi.getAllByways();\n            setByways(byways);\n        }\n        getBywaysForDisplay();\n    }, []);\n    // display error to user - try/catch?\n\n    async function filterByways(filters) {\n        try {\n            debugger\n            let byways = await BywayApi.search(filters);\n            setByways(byways);\n            if (!byways.length) {\n                history.push(\"/noresults\");\n            }\n        } catch (errors) {\n            if (errors.length > 0) {\n                addToast(errors[0], { appearance: 'error' });\n                // can add error messaging/alerts with Toast before anything is sent to the back, like so:\n                //addToast(\"your search term must be more than 3 characters\", { appearance: 'error' });\n            }\n            setErrors(errors);\n        }\n    }\n\n    async function search(name) {\n        let byways = await BywayApi.search({name});\n        setByways(byways);\n        if (!byways.length) {\n            history.push(\"/noresults\");\n            // Alert type=\"success\" messages={[\"Updated successfully.\"]} \n        }\n    }\n\n    return (\n        <div>\n            <div>\n                <SearchForm searchFor={search} filterByways={filterByways} errors={errors} />\n                {/* search and filterByways are defined here, passing them over to SearchForm to make them useable there; don't actually know if errors is necessary to pass, didn't end up using it */}\n            </div>\n            <div>\n                {currentByWays.length > 0\n                ? (\n                    <div>\n                        <div>\n                            {currentByWays.map(s => (\n                                <BywayCard\n                                    key={s.name + s.state}\n                                    name={s.name}\n                                    image={s.image}\n                                    designation={s.designation}\n                                />\n                            ))}\n                        </div>\n                        <div>\n                            <Pagination\n                                nPages={nPages}\n                                currentPage={currentPage}\n                                setCurrentPage={setCurrentPage}\n                            />\n                        </div>\n                        \n                    </div>\n                ) : (\n                    <h4>no byways in system.</h4>\n                )}\n            </div>\n        </div>\n        \n    );\n}\n\nexport default FilterSearch;\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}