{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/mike/Desktop/scenic/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from\"react\";import{useParams}from\"react-router-dom\";import BywayApi from\"../api/api\";import UserContext from\"../auth/UserContext\";import{NavLink}from\"react-router-dom\";import BywayCard from\"../byways/BywayCard\";import{useToasts}from'react-toast-notifications';// import { getUserFavorites } from \"../../backend/models/user\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ShowUserProfile(){var _useParams=useParams(),username=_useParams.username;var _useToasts=useToasts(),addToast=_useToasts.addToast;var _useContext=useContext(UserContext),currentUser=_useContext.currentUser;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isMe=_useState2[0],setIsMe=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),profileInfo=_useState4[0],setProfileInfo=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),userFavorites=_useState6[0],setUserFavorites=_useState6[1];var _useState7=useState('name'),_useState8=_slicedToArray(_useState7,2),sortBy=_useState8[0],setSortBy=_useState8[1];var _useState9=useState('asc'),_useState10=_slicedToArray(_useState9,2),sortDirection=_useState10[0],setSortDirection=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),formErrors=_useState12[0],setFormErrors=_useState12[1];function getUserFavorites(){return _getUserFavorites.apply(this,arguments);}function _getUserFavorites(){_getUserFavorites=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var userFavorites;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return BywayApi.getUserFavorites(username,sortBy,sortDirection);case 2:userFavorites=_context2.sent;setUserFavorites(userFavorites);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _getUserFavorites.apply(this,arguments);}useEffect(function(){function getUserInfo(){return _getUserInfo.apply(this,arguments);}function _getUserInfo(){_getUserInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var errors,_profileInfo;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:errors=formErrors;// attempted fix \n_context.prev=1;_context.next=4;return BywayApi.getCurrentUser(username);case 4:_profileInfo=_context.sent;setProfileInfo(_profileInfo);if(errors){_profileInfo.errors.forEach(function(i){return addToast(i,{appearance:'error'});});}_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);if(_context.t0.length>0){addToast(_context.t0[0],{appearance:'error'});}setFormErrors(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return _getUserInfo.apply(this,arguments);}getUserInfo();},[username]);useEffect(function(){if(currentUser&&profileInfo){setIsMe(currentUser.username===profileInfo.username);}},[profileInfo,currentUser]);useEffect(function(){// moved this to the top outside a useEffect to make it accessible to handleSubmitSortBy, but ended up not using it there, so could go back into this useEffect. don't think it matters if it's defined here or up top.\n// async function getUserFavorites() {\n//     let userFavorites = await BywayApi.getUserFavorites(username);\n//     setUserFavorites(userFavorites);\n// }\ngetUserFavorites();},[sortBy,sortDirection]);// handleSubmit for removal button in map\n// tell the function which byway is being removed by passing it into an anonymous function in the button's onClick below\nfunction handleSubmit(_x,_x2){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(username,byway_id){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return BywayApi.removeFavorite(username,byway_id);case 2:getUserFavorites();case 3:case\"end\":return _context3.stop();}}},_callee3);}));return _handleSubmit.apply(this,arguments);}function handleSubmitSortBy(_x3,_x4){return _handleSubmitSortBy.apply(this,arguments);}function _handleSubmitSortBy(){_handleSubmitSortBy=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(sortField,direction){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setSortBy(sortField);setSortDirection(direction);// sortField and direction get passed here from the onClick in JSX\ncase 2:case\"end\":return _context4.stop();}}},_callee4);}));return _handleSubmitSortBy.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{children:[isMe?/*#__PURE__*/_jsx(NavLink,{to:\"/profile/\",children:\"Edit your profile\"}):'',isMe?/*#__PURE__*/_jsxs(\"h3\",{children:[\"Welcome to the profile page of \",profileInfo.username]}):/*#__PURE__*/_jsxs(\"h3\",{children:[\"Welcome to the profile page of \",username]}),/*#__PURE__*/_jsx(\"img\",{src:profileInfo.profilePhoto,alt:\"profile photo\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Location: \",profileInfo.userLocation]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Favorite State to Travel To: \",profileInfo.favoriteState]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Bio: \",profileInfo.bio]}),/*#__PURE__*/_jsx(\"h1\",{children:\"USER FAVORITES\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Order favorites by:\"}),sortBy=='name'&&sortDirection=='asc'?/*#__PURE__*/ // these are the initial states for sortBy and sortDirection\n_jsx(\"button\",{onClick:function onClick(e){return handleSubmitSortBy('name','desc');},children:\"Z-A\"}):/*#__PURE__*/ // button starts as Z-A because byways are initially A-Z, so if user wanted to reverse order from that, button should be the opposite of what's initally shown\n_jsx(\"button\",{onClick:function onClick(e){return handleSubmitSortBy('name','asc');},children:\"A-Z\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return handleSubmitSortBy('length','asc');},children:\"Shortest to Longest\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return handleSubmitSortBy('length','desc');},children:\"Longest to Shortest\"}),/*#__PURE__*/_jsx(\"div\",{children:userFavorites.map(function(f){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(BywayCard,{name:f.name,image:f.image,designation:f.designation},f.name+f.state),isMe?/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleSubmit(username,f.byway_id);},children:\"Remove Favorite\"}):/*#__PURE__*/_jsx(\"span\",{})]});})})]});// currentUser wouldn't work right if someone is looking at a different user's profile?\n// maybe instead of BywayApi.getCurrentUser(username), BywayApi.getProfileInfo(username from params?)\n// need to create some profiles to have a better look\n}export default ShowUserProfile;","map":{"version":3,"names":["React","useState","useEffect","useContext","useParams","BywayApi","UserContext","NavLink","BywayCard","useToasts","ShowUserProfile","username","addToast","currentUser","isMe","setIsMe","profileInfo","setProfileInfo","userFavorites","setUserFavorites","sortBy","setSortBy","sortDirection","setSortDirection","formErrors","setFormErrors","getUserFavorites","getUserInfo","errors","getCurrentUser","forEach","i","appearance","length","handleSubmit","byway_id","removeFavorite","handleSubmitSortBy","sortField","direction","profilePhoto","userLocation","favoriteState","bio","e","map","f","name","image","designation","state"],"sources":["/Users/mike/Desktop/scenic/src/profiles/ProfilePage.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport BywayApi from \"../api/api\";\nimport UserContext from \"../auth/UserContext\";\nimport { NavLink } from \"react-router-dom\";\nimport BywayCard from \"../byways/BywayCard\";\nimport { useToasts } from 'react-toast-notifications';\n// import { getUserFavorites } from \"../../backend/models/user\";\n\nfunction ShowUserProfile() {\n    const { username } = useParams();\n    const { addToast } = useToasts();\n    const { currentUser } = useContext(UserContext);\n    const [isMe, setIsMe] = useState(false)\n    const [profileInfo, setProfileInfo] = useState({});\n    const [userFavorites, setUserFavorites] = useState([]);\n    const [sortBy, setSortBy] = useState('name');\n    const [sortDirection, setSortDirection] = useState('asc');\n    const [formErrors, setFormErrors] = useState([]);\n\n    async function getUserFavorites() {\n        let userFavorites = await BywayApi.getUserFavorites(username, sortBy, sortDirection);\n        setUserFavorites(userFavorites);\n    }\n\n    useEffect(() => {  \n        async function getUserInfo() {\n            let errors = formErrors;\n            // attempted fix \n            try {\n                let profileInfo = await BywayApi.getCurrentUser(username);\n                setProfileInfo(profileInfo);\n                if (errors) {\n                    profileInfo.errors.forEach(i =>  addToast(i, { appearance: 'error' }));\n                }    \n            } catch (errors) {\n                if (errors.length > 0) {\n                    addToast(errors[0], { appearance: 'error' });\n                }\n                setFormErrors(errors);\n            }\n        }\n        getUserInfo();\n    }, [username]);\n\n    useEffect(() => {\n        if (currentUser && profileInfo) {\n            setIsMe(currentUser.username === profileInfo.username);\n        }\n    }, [profileInfo, currentUser])   \n    \n    useEffect(() => {\n        // moved this to the top outside a useEffect to make it accessible to handleSubmitSortBy, but ended up not using it there, so could go back into this useEffect. don't think it matters if it's defined here or up top.\n        // async function getUserFavorites() {\n        //     let userFavorites = await BywayApi.getUserFavorites(username);\n        //     setUserFavorites(userFavorites);\n        // }\n        getUserFavorites();\n        \n    }, [sortBy, sortDirection])\n\n    // handleSubmit for removal button in map\n    // tell the function which byway is being removed by passing it into an anonymous function in the button's onClick below\n    async function handleSubmit(username, byway_id) {\n        await BywayApi.removeFavorite(username, byway_id);\n        getUserFavorites();\n    }\n\n    async function handleSubmitSortBy(sortField, direction) {\n        setSortBy(sortField)\n        setSortDirection(direction);\n        // sortField and direction get passed here from the onClick in JSX\n    }\n        \n    \n\n    return (\n        <div>\n            {isMe ? <NavLink to={`/profile/`}>Edit your profile</NavLink> : ''}\n            {isMe ? <h3>Welcome to the profile page of {profileInfo.username}</h3> : <h3>Welcome to the profile page of {username}</h3>}\n            <img src={profileInfo.profilePhoto} alt={\"profile photo\"} />\n            <h3>Location: {profileInfo.userLocation}</h3>\n            <h3>Favorite State to Travel To: {profileInfo.favoriteState}</h3>\n            <p>Bio: {profileInfo.bio}</p>\n            <h1>USER FAVORITES</h1>\n\n            <h4>Order favorites by:</h4>\n            {sortBy == 'name' && sortDirection == 'asc' ? \n            // these are the initial states for sortBy and sortDirection\n                (<button onClick={e => handleSubmitSortBy('name', 'desc')}>Z-A</button>) :\n                // button starts as Z-A because byways are initially A-Z, so if user wanted to reverse order from that, button should be the opposite of what's initally shown\n                (<button onClick={e => handleSubmitSortBy('name', 'asc')}>A-Z</button>)\n            }\n            <button onClick={e => handleSubmitSortBy('length', 'asc')}>Shortest to Longest</button>\n            <button onClick={e => handleSubmitSortBy('length', 'desc')}>Longest to Shortest</button>\n            <div>\n                    {userFavorites.map(f => (\n                        <div>\n                            <BywayCard\n                                key={f.name + f.state}\n                                name={f.name}\n                                image={f.image}\n                                designation={f.designation}\n                            />\n                            {isMe ? (\n                            <button onClick={() => handleSubmit(username, f.byway_id)}>\n                            Remove Favorite\n                            </button>) : <span></span> }\n                        </div>\n                    ))}\n                </div>\n        </div>\n    )\n    // currentUser wouldn't work right if someone is looking at a different user's profile?\n    // maybe instead of BywayApi.getCurrentUser(username), BywayApi.getProfileInfo(username from params?)\n    // need to create some profiles to have a better look\n}\n\nexport default ShowUserProfile;"],"mappings":"gWAAA,MAAOA,MAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CAC9D,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,MAAOC,SAAQ,KAAM,YAAY,CACjC,MAAOC,YAAW,KAAM,qBAAqB,CAC7C,OAASC,OAAO,KAAQ,kBAAkB,CAC1C,MAAOC,UAAS,KAAM,qBAAqB,CAC3C,OAASC,SAAS,KAAQ,2BAA2B,CACrD;AAAA,wFAEA,QAASC,gBAAe,EAAG,CACvB,eAAqBN,SAAS,EAAE,CAAxBO,QAAQ,YAARA,QAAQ,CAChB,eAAqBF,SAAS,EAAE,CAAxBG,QAAQ,YAARA,QAAQ,CAChB,gBAAwBT,UAAU,CAACG,WAAW,CAAC,CAAvCO,WAAW,aAAXA,WAAW,CACnB,cAAwBZ,QAAQ,CAAC,KAAK,CAAC,wCAAhCa,IAAI,eAAEC,OAAO,eACpB,eAAsCd,QAAQ,CAAC,CAAC,CAAC,CAAC,yCAA3Ce,WAAW,eAAEC,cAAc,eAClC,eAA0ChB,QAAQ,CAAC,EAAE,CAAC,yCAA/CiB,aAAa,eAAEC,gBAAgB,eACtC,eAA4BlB,QAAQ,CAAC,MAAM,CAAC,yCAArCmB,MAAM,eAAEC,SAAS,eACxB,eAA0CpB,QAAQ,CAAC,KAAK,CAAC,0CAAlDqB,aAAa,gBAAEC,gBAAgB,gBACtC,gBAAoCtB,QAAQ,CAAC,EAAE,CAAC,2CAAzCuB,UAAU,gBAAEC,aAAa,gBAAiB,QAElCC,iBAAgB,4JAA/B,mLAC8BrB,SAAQ,CAACqB,gBAAgB,CAACf,QAAQ,CAAES,MAAM,CAAEE,aAAa,CAAC,QAAhFJ,aAAa,gBACjBC,gBAAgB,CAACD,aAAa,CAAC,CAAC,wDACnC,mDAEDhB,SAAS,CAAC,UAAM,SACGyB,YAAW,6IAA1B,6JACQC,MAAM,CAAGJ,UAAU,CACvB;AAAA,sCAE4BnB,SAAQ,CAACwB,cAAc,CAAClB,QAAQ,CAAC,QAArDK,YAAW,eACfC,cAAc,CAACD,YAAW,CAAC,CAC3B,GAAIY,MAAM,CAAE,CACRZ,YAAW,CAACY,MAAM,CAACE,OAAO,CAAC,SAAAC,CAAC,QAAKnB,SAAQ,CAACmB,CAAC,CAAE,CAAEC,UAAU,CAAE,OAAQ,CAAC,CAAC,GAAC,CAC1E,CAAC,+EAED,GAAI,YAAOC,MAAM,CAAG,CAAC,CAAE,CACnBrB,QAAQ,CAAC,YAAO,CAAC,CAAC,CAAE,CAAEoB,UAAU,CAAE,OAAQ,CAAC,CAAC,CAChD,CACAP,aAAa,aAAQ,CAAC,oEAE7B,8CACDE,WAAW,EAAE,CACjB,CAAC,CAAE,CAAChB,QAAQ,CAAC,CAAC,CAEdT,SAAS,CAAC,UAAM,CACZ,GAAIW,WAAW,EAAIG,WAAW,CAAE,CAC5BD,OAAO,CAACF,WAAW,CAACF,QAAQ,GAAKK,WAAW,CAACL,QAAQ,CAAC,CAC1D,CACJ,CAAC,CAAE,CAACK,WAAW,CAAEH,WAAW,CAAC,CAAC,CAE9BX,SAAS,CAAC,UAAM,CACZ;AACA;AACA;AACA;AACA;AACAwB,gBAAgB,EAAE,CAEtB,CAAC,CAAE,CAACN,MAAM,CAAEE,aAAa,CAAC,CAAC,CAE3B;AACA;AAAA,QACeY,aAAY,sJAA3B,kBAA4BvB,QAAQ,CAAEwB,QAAQ,+IACpC9B,SAAQ,CAAC+B,cAAc,CAACzB,QAAQ,CAAEwB,QAAQ,CAAC,QACjDT,gBAAgB,EAAE,CAAC,wDACtB,uDAEcW,mBAAkB,yKAAjC,kBAAkCC,SAAS,CAAEC,SAAS,wHAClDlB,SAAS,CAACiB,SAAS,CAAC,CACpBf,gBAAgB,CAACgB,SAAS,CAAC,CAC3B;AAAA,wDACH,qDAID,mBACI,uBACKzB,IAAI,cAAG,KAAC,OAAO,EAAC,EAAE,YAAc,UAAC,mBAAiB,EAAU,CAAG,EAAE,CACjEA,IAAI,cAAG,sBAAI,iCAA+B,CAACE,WAAW,CAACL,QAAQ,GAAM,cAAG,sBAAI,iCAA+B,CAACA,QAAQ,GAAM,cAC3H,YAAK,GAAG,CAAEK,WAAW,CAACwB,YAAa,CAAC,GAAG,CAAE,eAAgB,EAAG,cAC5D,sBAAI,YAAU,CAACxB,WAAW,CAACyB,YAAY,GAAM,cAC7C,sBAAI,+BAA6B,CAACzB,WAAW,CAAC0B,aAAa,GAAM,cACjE,qBAAG,OAAK,CAAC1B,WAAW,CAAC2B,GAAG,GAAK,cAC7B,oBAAI,gBAAc,EAAK,cAEvB,oBAAI,qBAAmB,EAAK,CAC3BvB,MAAM,EAAI,MAAM,EAAIE,aAAa,EAAI,KAAK,eAC3C;AACK,eAAQ,OAAO,CAAE,iBAAAsB,CAAC,QAAIP,mBAAkB,CAAC,MAAM,CAAE,MAAM,CAAC,EAAC,UAAC,KAAG,EAAS,eACvE;AACC,eAAQ,OAAO,CAAE,iBAAAO,CAAC,QAAIP,mBAAkB,CAAC,MAAM,CAAE,KAAK,CAAC,EAAC,UAAC,KAAG,EAAU,cAE3E,eAAQ,OAAO,CAAE,iBAAAO,CAAC,QAAIP,mBAAkB,CAAC,QAAQ,CAAE,KAAK,CAAC,EAAC,UAAC,qBAAmB,EAAS,cACvF,eAAQ,OAAO,CAAE,iBAAAO,CAAC,QAAIP,mBAAkB,CAAC,QAAQ,CAAE,MAAM,CAAC,EAAC,UAAC,qBAAmB,EAAS,cACxF,qBACSnB,aAAa,CAAC2B,GAAG,CAAC,SAAAC,CAAC,qBAChB,oCACI,KAAC,SAAS,EAEN,IAAI,CAAEA,CAAC,CAACC,IAAK,CACb,KAAK,CAAED,CAAC,CAACE,KAAM,CACf,WAAW,CAAEF,CAAC,CAACG,WAAY,EAHtBH,CAAC,CAACC,IAAI,CAAGD,CAAC,CAACI,KAAK,CAIvB,CACDpC,IAAI,cACL,eAAQ,OAAO,CAAE,yBAAMoB,aAAY,CAACvB,QAAQ,CAAEmC,CAAC,CAACX,QAAQ,CAAC,EAAC,UAAC,iBAE3D,EAAS,cAAI,eAAa,GACxB,EACT,CAAC,EACA,GACR,CAEV;AACA;AACA;AACJ,CAEA,cAAezB,gBAAe"},"metadata":{},"sourceType":"module"}